(this.webpackJsonpwipw=this.webpackJsonpwipw||[]).push([[0],{155:function(e,t,a){},157:function(e,t,a){},158:function(e,t,a){},159:function(e,t,a){},169:function(e,t,a){},170:function(e,t,a){},171:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(71),s=a.n(r),i=(a(84),a(6)),c=a(14),l=a(13),m=Object(l.a)(),u=a(72),d=a(3),f=a(73),g=a(74),p=a(19),h=a(8),b=a.n(h),w=function(){function e(t,a){Object(f.a)(this,e),this.userPool=new p.d({UserPoolId:t.userPoolId,ClientId:t.clientId}),this.awsConfig=a,this.authCfg=t}return Object(g.a)(e,[{key:"registerUser",value:function(e){var t=this;return new Promise((function(a,n){t.userPool.signUp(e.email,e.password,[new p.c({Name:"website",Value:"jkan.pl"}),new p.c({Name:"nickname",Value:e.fullName})],null,(function(e,t){e&&n(e),a(t)}))}))}},{key:"confirmAccount",value:function(e){var t=this;return new Promise((function(a,n){new p.b({Username:e.username,Pool:t.userPool}).confirmRegistration(e.confirmationCode,!0,(function(e,t){e?n(e):a(t)}))}))}},{key:"login",value:function(e){var t=this;return new Promise((function(a,n){new p.b({Username:e.username,Pool:t.userPool}).authenticateUser(new p.a({Username:e.username,Password:e.password}),{onSuccess:function(e){t.awsConfig.credentials=new h.CognitoIdentityCredentials({IdentityPoolId:t.authCfg.identityPoolId,Logins:Object(d.a)({},t.authCfg.credentialName,e.getIdToken().getJwtToken())}),t.awsConfig.credentials.refresh((function(e){e?console.error(e):console.log("Successfully logged!")})),a(e)},onFailure:function(e){return n(e)}})}))}},{key:"getAccessToken",value:function(){var e=this;return new Promise((function(t,a){var n=e.userPool.getCurrentUser();null==n&&a("user not authorized"),n.getSession((function(e,n){e&&a(e),t(n.getIdToken().getJwtToken())}))}))}},{key:"refreshSession",value:function(){var e=this;return new Promise((function(t,a){var n=e.userPool.getCurrentUser();null==n&&a("user not authorized"),n.getSession((function(o,r){o&&a(o),e.awsConfig.credentials=new h.CognitoIdentityCredentials({IdentityPoolId:e.authCfg.identityPoolId,Logins:Object(d.a)({},e.authCfg.credentialName,r.getIdToken().getJwtToken())}),n.getUserAttributes((function(e,n){e&&a(e),t(n.reduce((function(e,t){return Object(u.a)({},e,Object(d.a)({},t.Name,t.Value))}),{}))}))}))}))}}]),e}(),E="cognito-idp.".concat("eu-west-1",".amazonaws.com/").concat("eu-west-1_j54jnd7Px"),v={userPoolId:"eu-west-1_j54jnd7Px",clientId:"evmsouskqjs2d1e70mmj2fo3m",identityPoolId:"eu-west-1:d6ce9d7b-42e1-40e7-aa10-67e32e0bca38",credentialName:E},N=(a(155),a(11)),y=a(23),j=o.a.createContext({isAuth:!1,toggleAuth:function(){}}),S=j.Provider,O=j,P=(a(157),function(e){var t=e.message;return o.a.createElement("div",{className:"invalid-feedback"},t)});b.a.config.region="eu-west-1";var k=new w(v,b.a.config),C=N.a().shape({email:N.b().email().required(),password:N.b().min(4,"Your password should be a minimum of 4 characters")}),I=function(e){var t=Object(n.useContext)(O).setAuth,a=Object(n.useState)(null),r=Object(i.a)(a,2),s=r[0],c=(r[1],Object(y.a)({validationSchema:C})),l=c.register,u=c.handleSubmit,d=c.errors,f=u((function(e){var a={username:e.email,password:e.password};k.login(a).then((function(e){k.refreshSession(),t(!0)})).then((function(e){m.push("/dashboard")})).catch((function(e){return console.log("access deny"+e.message)}))}));return o.a.createElement("div",{className:"loginPage"},o.a.createElement("div",{className:"container h-100"},o.a.createElement("div",{className:"row h-100 align-items-center justify-content-center"},o.a.createElement("div",{className:"col-md-8"},o.a.createElement("div",{className:"loginFormWrapper"},o.a.createElement("form",{onSubmit:f},o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{form:"emailLogin"},"Login"),o.a.createElement("input",{name:"email",type:"email",ref:l,id:"emailLogin",className:"form-control","data-testid":"email"}),d.email&&o.a.createElement(P,{message:String(d.email.message)})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{form:"loginPassword"},"Password"),o.a.createElement("input",{name:"password",type:"password",ref:l,id:"loginPassword",className:"form-control",onKeyPress:function(e){if(13!==e.which)return e;f()},"data-testid":"password"}),d.password&&o.a.createElement(P,{message:String(d.password.message)})),o.a.createElement("button",{type:"submit","data-testid":"submit",className:"btn btn-primary"},"Log In")),s&&o.a.createElement(P,{message:s}))))))};a(158);b.a.config.region="eu-west-1";var A=new w(v,b.a.config),U=N.a().shape({email:N.b().email().required(),code:N.b().required()}),F=function(e){var t=Object(n.useState)(null),a=Object(i.a)(t,2),r=a[0],s=(a[1],Object(y.a)({validationSchema:U})),c=s.register,l=s.handleSubmit,u=s.errors,d=l((function(e){var t={username:e.email,confirmationCode:e.code};console.log("User ".concat(t.username," is going to be confirmed")),A.confirmAccount(t).then((function(e){console.log("All is fine, user registered"),m.push("/login")})).catch((function(e){return console.log("Sth is not YESS"+e.message)}))}));return o.a.createElement("div",{className:"loginPage"},o.a.createElement("div",{className:"container h-100"},o.a.createElement("div",{className:"row h-100 align-items-center justify-content-center"},o.a.createElement("div",{className:"col-md-8"},o.a.createElement("div",{className:"loginFormWrapper"},o.a.createElement("form",{onSubmit:d},o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{form:"email"},"Email"),o.a.createElement("input",{name:"email",type:"email",ref:c,id:"email",className:"form-control","data-testid":"email"}),u.email&&o.a.createElement(P,{message:String(u.email.message)})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{form:"code"},"Code"),o.a.createElement("input",{name:"code",type:"confirmCodeInput",ref:c,id:"code",className:"form-control"}),u.code&&o.a.createElement(P,{message:String(u.code.message)})),o.a.createElement("button",{type:"submit","data-testid":"submit",className:"btn btn-primary"},"Confirm")),r&&o.a.createElement(P,{message:r}))))))},T=a(7),x=(a(159),a(34)),L=a.n(x);b.a.config.region="eu-west-1";var q=new w(v,b.a.config),B=function(e){var t=Object(n.useState)(null),a=Object(i.a)(t,2),r=(a[0],a[1]),s=Object(n.useState)("Choose File"),c=Object(i.a)(s,2),l=c[0],m=c[1],u=Object(n.useState)(null),d=Object(i.a)(u,2),f=d[0],g=d[1],p=Object(n.useRef)();return o.a.createElement("div",{className:"loginPage"},o.a.createElement("div",{className:"container h-100"},o.a.createElement("div",{className:"row h-100 align-items-center justify-content-center"},o.a.createElement("div",{className:"col-md-8"},o.a.createElement("div",{className:"loginFormWrapper"},o.a.createElement("div",{className:"file-wrapper"},o.a.createElement("button",{className:"btn btn-primary",onClick:function(){var e={Bucket:"213774",MaxKeys:100};(new L.a).listObjects(e,(function(e,t){e&&(console.log(e),r("something went wrong")),g(t),console.log(t)}))}}," Show files from bucket"),f&&o.a.createElement("ul",null,f.Contents.map((function(e){return o.a.createElement("li",null,e.Key)})))),o.a.createElement("div",{className:"input-group mb-3"},o.a.createElement("div",{className:"input-group-prepend",onClick:function(){Object(T.a)(p.current.files).forEach((function(e,t){(function(e){var t=b.a.config.credentials.identityId,a={Body:e,Bucket:"213774",Key:"uek-krakow/".concat(t,"/photos/").concat(e.name)};return new Promise((function(e,t){(new L.a).putObject(a,(function(n,o){n&&t(n),e(a.Key)}))}))})(e).then((function(e){return function(e){var t={Bucket:"213774",Key:e};return(new L.a).getSignedUrl("getObject",t)}(e)})).catch((function(e){return console.log(e)})).finally((function(){p.value="",m("Choose File")}))}))}},o.a.createElement("span",{className:"input-group-text"},"Upload")),o.a.createElement("div",{className:"custom-file"},o.a.createElement("input",{type:"file",className:"custom-file-input",id:"inputGroupFile01",onChange:function(){p.current.files&&p.current.files.length>0&&m(p.current.files[0].name)},ref:p}),o.a.createElement("label",{className:"custom-file-label",htmlFor:"inputGroupFile01"},l))),o.a.createElement("div",{className:"orderAnimation"},o.a.createElement("button",{className:"btn btn-primary",onClick:function(){var e;q.getAccessToken().then((function(t){return console.log(t),fetch("".concat("https://rrdhk1j3ii.execute-api.eu-west-1.amazonaws.com/dev","/animations-orders"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:t},body:JSON.stringify({photos:e,meta1:"meta_value"})})})).then((function(e){console.log("Hurra it works"),console.log(e)})).catch((function(e){return console.log(e)}))}},"Order Animation")))))))},J=function(e){var t=Object(n.useContext)(O).isAuth;return Object(n.useEffect)((function(){t||m.push("/login")}),[t]),o.a.createElement(c.b,e)},K=function(){return o.a.createElement("h3",null,"404")};a(169),a(170);b.a.config.region="eu-west-1";var W=new w(v,b.a.config),z=N.a().shape({email:N.b().email().required(),fullName:N.b().required(),password:N.b().min(4,"Your password should be a minimum of 4 characters")}),Y=function(e){var t=Object(n.useState)(null),a=Object(i.a)(t,2),r=a[0],s=a[1],c=Object(y.a)({validationSchema:z}),l=c.register,u=c.handleSubmit,d=c.errors,f=u((function(e){var t={email:e.email,password:e.password,fullName:e.fullName};W.registerUser(t).then((function(e){console.log("All is fine, user registered"),m.push("/confirm")})).catch((function(e){console.log("Sth is not YESS"+e.message),s("something wnet wrong")}))}));return o.a.createElement("div",{className:"loginPage"},o.a.createElement("div",{className:"container h-100"},o.a.createElement("div",{className:"row h-100 align-items-center justify-content-center"},o.a.createElement("div",{className:"col-md-8"},o.a.createElement("div",{className:"loginFormWrapper"},o.a.createElement("form",{onSubmit:f},o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{form:"email"},"Login"),o.a.createElement("input",{name:"email",type:"email",ref:l,id:"email",className:"form-control","data-testid":"email"}),d.email&&o.a.createElement(P,{message:String(d.email.message)})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{form:"password"},"Password"),o.a.createElement("input",{name:"password",type:"password",ref:l,id:"password",className:"form-control","data-testid":"password"}),d.password&&o.a.createElement(P,{message:String(d.password.message)})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{form:"fullName"},"Full Name"),o.a.createElement("input",{name:"fullName",type:"fullName",ref:l,id:"fullName",className:"form-control","data-testid":"fullName"}),d.fullName&&o.a.createElement(P,{message:String(d.password.message)})),o.a.createElement("button",{type:"submit","data-testid":"submit",className:"btn btn-primary"},"Register")),r&&o.a.createElement(P,{message:r}))))))};b.a.config.region="eu-west-1";var R=new w(v,b.a.config),V=function(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),r=a[0],s=a[1];return Object(n.useEffect)((function(){R.refreshSession().then((function(e){s(!0)})).catch()}),[]),o.a.createElement(S,{value:{isAuth:r,setAuth:function(e){s(e)}}},o.a.createElement(c.d,null,o.a.createElement(c.b,{path:"/login",component:I}),o.a.createElement(c.b,{path:"/signup",component:Y}),o.a.createElement(c.b,{path:"/confirm",component:F}),o.a.createElement(J,{path:"/dashboard",component:B}),o.a.createElement(c.b,{component:K})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(c.c,{history:m},o.a.createElement(V,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},40:function(e,t){},79:function(e,t,a){e.exports=a(171)},84:function(e,t,a){}},[[79,1,2]]]);
//# sourceMappingURL=main.29d96fc9.chunk.js.map